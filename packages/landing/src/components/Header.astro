---
import { useTranslations } from '../i18n';

interface Props {
  lang?: string;
}

const { lang = 'sv' } = Astro.props;
const { t } = useTranslations(lang);
const appUrl = import.meta.env.PUBLIC_APP_URL;

const navigationData = [
  { title: t('navigation.features'), href: '#features' },
  { title: t('navigation.modules'), href: '#modules' },
  { title: t('navigation.pricing'), href: '#pricing' },
  { title: t('navigation.documentation'), href: '#documentation' },
];

const alternateLang = lang === 'sv' ? 'en' : 'sv';
const alternateUrl = lang === 'sv' ? '/en/' : '/';
const alternateLabel = lang === 'sv' ? 'English' : 'Svenska';
---

<header class="bg-background sticky top-0 z-50 h-16 border-b">
  <div class="mx-auto flex h-full max-w-7xl items-center justify-between gap-6 px-4 sm:px-6 lg:px-8">
    <!-- Logo -->
    <a href={lang === 'sv' ? '/' : '/en/'} class="flex items-center gap-2.5">
      <img src="/images/equiduty-icon.png" alt="EquiDuty" class="h-9 w-9 rounded-lg" />
      <span class="text-xl font-semibold text-[#3d5a45]">EquiDuty</span>
    </a>

    <!-- Navigation (desktop) -->
    <nav class="hidden md:flex items-center gap-1">
      {navigationData.map((item) => (
        <a
          href={item.href}
          class="text-muted-foreground hover:text-primary px-3 py-1.5 text-base font-medium transition-colors"
        >
          {item.title}
        </a>
      ))}
    </nav>

    <!-- Right side: Language + Auth (desktop) -->
    <div class="hidden md:flex items-center gap-2">
      <a
        href={alternateUrl}
        class="inline-flex items-center justify-center rounded-md px-3 py-1.5 text-sm font-medium text-muted-foreground hover:text-foreground hover:bg-accent transition-colors"
      >
        {alternateLabel}
      </a>
      <a
        href={`${appUrl}/login`}
        class="inline-flex items-center justify-center rounded-md px-4 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground transition-colors"
      >
        {t('navigation.login')}
      </a>
      <a
        href={`${appUrl}/register`}
        class="inline-flex items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90 transition-colors"
      >
        {t('navigation.register')}
      </a>
    </div>

    <!-- Mobile: Language + Login + Menu -->
    <div class="flex items-center gap-2 md:hidden">
      <a
        href={alternateUrl}
        class="inline-flex items-center justify-center rounded-md px-2 py-1 text-xs font-medium text-muted-foreground hover:text-foreground hover:bg-accent transition-colors"
      >
        {alternateLabel}
      </a>
      <a
        href={`${appUrl}/login`}
        class="inline-flex items-center justify-center rounded-md bg-primary px-3 py-1.5 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90 transition-colors"
      >
        {t('navigation.login')}
      </a>
      <button
        id="mobile-menu-toggle"
        class="inline-flex items-center justify-center rounded-md border border-input bg-background p-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground transition-colors"
        aria-label="Menu"
      >
        <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Mobile menu dropdown -->
  <div id="mobile-menu" class="hidden md:hidden border-b bg-background">
    <div class="px-4 py-3 space-y-1">
      {navigationData.map((item) => (
        <a
          href={item.href}
          class="block rounded-md px-3 py-2 text-sm font-medium text-muted-foreground hover:text-foreground hover:bg-accent transition-colors"
        >
          {item.title}
        </a>
      ))}
    </div>
  </div>
</header>

<script>
  const toggle = document.getElementById('mobile-menu-toggle');
  const menu = document.getElementById('mobile-menu');
  if (toggle && menu) {
    toggle.addEventListener('click', () => {
      menu.classList.toggle('hidden');
    });
  }
</script>
